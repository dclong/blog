Status: published
Author: Ben Chuanlong Du
Title: SSH Tips
Date: 2020-02-29 21:37:59
Slug: ssh-tips
Category: Software
Tags: tips, SSH, software, remote, Linux

**
Things on this page are fragmentary and immature notes/thoughts of the author.
It is not meant to readers but rather for convenient reference of the author and future improvement.
**
## Tips and Traps

1. SSH automatically maintains and checks a database containing identification 
    for all hosts it has ever been used with. 
    Host keys are stored in `~/.ssh/known_hosts` in the user's home directory. 
    Additionally, 
    the file `/etc/ssh/ssh_known_hosts` is automatically checked for known hosts. 
    Any new hosts are automatically added to the user's file. 
    If a host's identification ever changes, 
    SSH warns about this and disables password authentication 
    to prevent server spoofing or man-in-the-middle attacks, 
    which could otherwise be used to circumvent the encryption. 
    The option `-o StrictHostKeyChecking=no` can be used to turn off strict host key checking
    (on both new host keys and changed host keys).

        :::bash
        ssh -o StrictHostKeyChecking=no your_server

    You can also turn of strickt host key checking permanently by adding the following line into `~/.ssh/config`.

        StrictHostKeyChecking no

    This is helpful for automation when you are in a safe environment (e.g., private VPN). 
    However, 
    be aware of the risk and avoid using it in public environment.
    For more details, 
    please refer to
    [ssh(1) - Linux man page](https://linux.die.net/man/1/ssh)
    and
    [SSH: Disable Host Checking for Scripts & Automation](http://bencane.com/2013/07/22/ssh-disable-host-checking-for-scripts-automation/).

2. You can use the option `-o ProxyCommand='ssh proxy_server -W %h:%p'` 
    to SSH into a machine via a proxy server.
    Below is an illustration.
    For more details,
    please refer to
    [SSH Proxies and Jump Hosts](https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts).

        :::bash
        ssh -o ProxyCommand='ssh proxy_server -W %h:%p' target_server

3. When using `sshfs` and `fuse`, 
    make sure to add your user account into the `fuse` group.

        :::bash
        gpasswd -a dclong fuse
        newgrp fuse

4. It is suggested that you do not set any password for your SSH keys. 
    First, setting passwords for SSH keys defeats the purpose of using SSH keys.
    Seconds, 
    settings passwords for SSH keys might causes problems to other applicatons 
    (e.g., keyring management, cron jobs, duplicity, etc.) rely on SSH.


## References

https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts

https://www.cyberciti.biz/faq/linux-unix-ssh-proxycommand-passing-through-one-host-gateway-server/

https://stackoverflow.com/questions/22635613/what-is-the-difference-between-ssh-proxycommand-w-nc-exec-nc

